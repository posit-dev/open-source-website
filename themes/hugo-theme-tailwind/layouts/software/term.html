{{ define "main" }}
<div class="flex flex-col w-full max-w-4xl lg:max-w-5xl">
  <!-- Software Profile Section -->
  <div class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-blue-950">
    <div class="flex flex-col md:flex-row gap-6 p-6">
      {{ if .Params.image }}
        {{ $image := .Resources.Get .Params.image }}
        {{ if $image }}
          <div class="flex-shrink-0 w-48 h-48 flex items-center justify-center bg-white dark:bg-blue-900 rounded-lg p-4">
            {{ $baseSize := mul 40 4 }}
            {{ partial "responsive_image_fixed.html" (dict "image" $image "baseWidth" $baseSize "baseHeight" $baseSize "alt" .Title "class" "max-h-full max-w-full object-contain" "method" "fit" "addPagefindMeta" true) }}
          </div>
        {{ end }}
      {{ end }}

      <div class="flex flex-col gap-y-3 flex-grow">
        <h1 class="text-4xl font-medium text-gray-500 dark:text-gray-100">
          {{ .Title }}
        </h1>

        {{ with .Params.description }}
          <p class="text-lg text-gray-600 dark:text-gray-300">
            {{ . }}
          </p>
        {{ end }}

        <!-- Links -->
        <div class="flex flex-row gap-3 mt-2">
          {{ with .Params.github }}
            <a href="https://github.com/{{ . }}" target="_blank" title="GitHub Repository" class="text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-200 transition-colors">
              <i class="h-6 w-6 flex-none">{{ partial "icon.html" "brand-github" }}</i>
            </a>
          {{ end }}
          {{ with .Params.website }}
            <a href="{{ . }}" target="_blank" title="Website" class="text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-200 transition-colors">
              <i class="h-6 w-6 flex-none">{{ partial "icon.html" "world" }}</i>
            </a>
          {{ end }}
        </div>

        <!-- Languages -->
        {{ with .Params.languages }}
          <div class="flex flex-row flex-wrap gap-2 mt-2">
            {{ range . }}
            <span class="text-sm px-3 py-1 rounded-full bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 font-medium">
              {{ . }}
            </span>
            {{ end }}
          </div>
        {{ end }}

        {{ if .Content }}
          <div class="prose prose dark:prose-invert max-w-none mt-4">
            {{ .Content }}
          </div>
        {{ end }}
      </div>
    </div>
  </div>

  <!-- Contributors Section -->
  {{ $people := .GetTerms "people" }}
  {{ if $people }}
    <div class="mt-8 mb-6 mx-2 md:mx-0">
      <h2 class="text-2xl font-medium dark:text-gray-200 mb-4">
        Contributors
      </h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mx-2 md:mx-0 mb-6">
      {{ range $people }}
        {{ partial "card_person.html" . }}
      {{ end }}
    </div>
  {{ end }}

  <!-- Events featuring this Software -->
  {{ $events := where .Pages "Section" "events" }}
  {{ if gt (len $events) 0 }}
    <div class="mt-8 mb-6 mx-2 md:mx-0">
      <h2 class="text-2xl font-medium text-gray-800 dark:text-gray-200 mb-4">
        Events featuring {{ .Title }}
      </h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mx-2 md:mx-0 mb-6">
      {{ range $events }}
        {{ partial "card_event.html" . }}
      {{ end }}
    </div>
  {{ end }}

  <!-- Resources using this Software -->
  {{ $resources := where .Pages "Section" "resources" }}
  {{ if gt (len $resources) 0 }}
    <div class="mt-8 mb-6 mx-2 md:mx-0">
      <h2 class="text-2xl font-medium text-gray-800 dark:text-gray-200 mb-4">
        Resources using {{ .Title }}
      </h2>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mx-2 md:mx-0 mb-6">
      {{ range $resources }}
        {{ partial "card_resource.html" . }}
      {{ end }}
    </div>
  {{ end }}

  <!-- Blog Posts about this Software -->
  {{ $posts := where .Pages "Section" "blog" }}
  {{ if gt (len $posts) 0 }}
    <div class="mt-8 mb-6 mx-2 md:mx-0">
      <h2 class="text-2xl font-medium text-gray-800 dark:text-gray-200 mb-4">
        Posts about {{ .Title }}
      </h2>
    </div>

    <div class="flex flex-col">
      {{ range $posts }}
        <article class="flex flex-col mt-6 mx-2 md:mx-0 rounded-lg overflow-hidden shadow-md bg-white dark:bg-blue-950">
          <div>
            <a href="{{ .RelPermalink }}">
              {{ partial "block/image.html" . }}
            </a>
          </div>
          <div class="flex flex-col gap-y-3 p-6">
            <h3 class="text-3xl font-medium text-gray-800 dark:text-gray-200">
              <a href="{{ .RelPermalink }}">{{ .Title | .RenderString }}</a>
            </h3>

            {{ partial "block/desc.html" . }}
            {{ partial "block/taxonomies.html" . }}
            {{ partial "block/time.html" . }}
          </div>
        </article>
      {{ end }}
    </div>
  {{ end }}
</div>
{{ end }}